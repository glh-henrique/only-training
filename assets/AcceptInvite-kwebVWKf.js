import{r,j as e}from"./vendor-RJ-jBvc8.js";import{b as h,s as g}from"./index-DfMx629v.js";import{B as o}from"./button-D3CWm_we.js";import{u as j}from"./i18n-DvSS2Fqm.js";import{s as N,k}from"./icons-CewslWSu.js";import{u as v,c as w}from"./router-Db51iocS.js";import"./supabase-BfAM1BYj.js";function P(){const{t}=j(),i=v(),d=w(),p=h(s=>s.role),f=h(s=>s.refreshProfileContext),a=r.useMemo(()=>new URLSearchParams(d.search).get("token")||"",[d.search]),[u,m]=r.useState(!1),[c,l]=r.useState("idle"),[x,n]=r.useState(null),b=async()=>{if(!a){l("error"),n(t("coach.accept.invalid_token"));return}m(!0),n(null);try{const{error:s}=await g.rpc("accept_coach_invite",{token_input:a});if(s)throw s;await f(),l("success")}catch(s){l("error"),n(s.message||t("coach.accept.generic_error"))}finally{m(!1)}};return p!=="aluno"?e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 text-center space-y-3",children:[e.jsx(N,{className:"h-8 w-8 text-amber-500 mx-auto"}),e.jsx("h1",{className:"text-xl font-bold",children:t("coach.accept.only_student_title")}),e.jsx("p",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:t("coach.accept.only_student_desc")}),e.jsx(o,{onClick:()=>i("/"),className:"w-full",children:t("common.ok")})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center p-4",children:e.jsxs("div",{className:"max-w-md w-full bg-neutral-50 dark:bg-neutral-900 border border-neutral-200 dark:border-neutral-800 rounded-2xl p-6 space-y-4",children:[e.jsx("h1",{className:"text-xl font-bold",children:t("coach.accept.title")}),e.jsx("p",{className:"text-sm text-neutral-500 dark:text-neutral-400",children:t("coach.accept.subtitle")}),!a&&e.jsx("div",{className:"p-3 rounded-lg bg-red-500/10 text-red-500 text-sm",children:t("coach.accept.invalid_token")}),c==="success"&&e.jsxs("div",{className:"p-3 rounded-lg bg-emerald-500/10 text-emerald-600 text-sm flex items-center gap-2",children:[e.jsx(k,{className:"h-4 w-4"}),t("coach.accept.success")]}),c==="error"&&x&&e.jsx("div",{className:"p-3 rounded-lg bg-red-500/10 text-red-500 text-sm",children:x}),e.jsxs("div",{className:"space-y-2",children:[e.jsx(o,{className:"w-full",onClick:b,disabled:u||!a||c==="success",children:t(u?"common.loading":"coach.accept.submit")}),e.jsx(o,{variant:"outline",className:"w-full",onClick:()=>i("/"),children:t("coach.accept.go_home")})]})]})})}export{P as default};
