import{r as s,j as e}from"./vendor-RJ-jBvc8.js";import{u as ne,b as de,g as _,s as oe,c as I}from"./index-DfMx629v.js";import{B as c}from"./button-D3CWm_we.js";import{I as l}from"./input-PBOW6J0D.js";import{S as i}from"./skeleton-Dc00BBcn.js";import{u as ce}from"./i18n-DvSS2Fqm.js";import{b as ie,d as xe,u as me}from"./router-Db51iocS.js";import{h as ue,X as he,i as pe,G as be,V as ge,a as Ne,b as je,c as ve}from"./icons-CewslWSu.js";import"./supabase-BfAM1BYj.js";function Ue(){const{t:a}=ce(),{workoutId:o}=ie(),[H]=xe(),n=H.get("owner")||void 0,J=me(),{activeWorkoutItems:p,fetchWorkoutItems:S,addWorkoutItem:K,updateWorkoutItem:M,deleteWorkoutItem:O}=ne(),C=de(t=>t.user),[Y,Z]=s.useState(""),[h,E]=s.useState(""),[b,U]=s.useState(""),[g,V]=s.useState(""),[N,R]=s.useState(""),[W,z]=s.useState(""),[x,L]=s.useState(""),[$,P]=s.useState(!1),[ee,te]=s.useState(!0),[A,j]=s.useState(null),[q,B]=s.useState(""),[v,G]=s.useState(""),[w,Q]=s.useState(""),[k,T]=s.useState(""),[D,X]=s.useState(""),[m,F]=s.useState(""),f=x.trim().length>0&&!_(x),y=m.trim().length>0&&!_(m);s.useEffect(()=>{if(o&&C){const t=oe.from("workouts").select("name").eq("id",o),d=n?t.eq("user_id",n):t;Promise.all([S(o,n),d.single()]).then(([r,{data:u}])=>{u&&Z(u.name),te(!1)})}},[o,S,C,n]);const ae=async t=>{t.preventDefault(),!(!h||!o)&&(P(!0),await K(o,h,p.length,b||void 0,g?parseInt(g):void 0,N?parseInt(N):void 0,W,x.trim()?x.trim():void 0,n),E(""),U(""),V(""),R(""),z(""),L(""),P(!1))},se=t=>{var d,r,u;j(t.id),B(t.title),G(((d=t.default_reps)==null?void 0:d.toString())||""),Q(((r=t.default_sets)==null?void 0:r.toString())||""),T(((u=t.rest_seconds)==null?void 0:u.toString())||""),X(t.notes||""),F(t.video_url||"")},re=()=>{j(null)},le=async t=>{await M(t,{title:q,default_reps:v||void 0,default_sets:w?parseInt(w):void 0,rest_seconds:k?parseInt(k):void 0,notes:D,video_url:m.trim()?m.trim():void 0},n),j(null)};return e.jsxs("div",{className:"min-h-screen bg-white dark:bg-neutral-950 text-neutral-900 dark:text-white pb-20 transition-colors",children:[e.jsxs("header",{className:"p-4 flex items-center gap-4 border-b border-neutral-200 dark:border-neutral-800 bg-white dark:bg-neutral-950 sticky top-0 z-10 transition-colors",children:[e.jsx(c,{variant:"ghost",size:"icon",onClick:()=>J("/"),className:"text-neutral-500 dark:text-neutral-400",children:e.jsx(ue,{className:"h-5 w-5"})}),e.jsx("h1",{className:"font-bold text-lg",children:a("editor.title",{name:Y})})]}),ee?e.jsxs("main",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx(i,{className:"h-4 w-24"}),e.jsx("div",{className:"space-y-2",children:[1,2,3,4].map(t=>e.jsxs("div",{className:"flex items-center gap-3 bg-neutral-50 dark:bg-neutral-900 p-3 rounded-lg border border-neutral-200 dark:border-neutral-800",children:[e.jsx(i,{className:"h-5 w-5 rounded"}),e.jsxs("div",{className:"flex-1 space-y-2",children:[e.jsx(i,{className:"h-5 w-32"}),e.jsx(i,{className:"h-3 w-40"})]}),e.jsx(i,{className:"h-8 w-8 rounded-full"})]},t))})]}),e.jsx(i,{className:"h-32 w-full rounded-xl"})]}):e.jsxs("main",{className:"p-4 space-y-6",children:[e.jsxs("div",{className:"space-y-2",children:[e.jsx("h2",{className:"text-sm font-bold text-neutral-400 dark:text-neutral-500 uppercase tracking-wider px-1",children:a("editor.exercises")}),e.jsxs("div",{className:"space-y-2",children:[p.map(t=>{const d=_(t.video_url);return e.jsx("div",{className:I("bg-neutral-50 dark:bg-neutral-900 rounded-lg border transition-all",A===t.id?"p-4 border-emerald-500/50 ring-1 ring-emerald-500/20 shadow-lg shadow-emerald-500/5":"p-3 border-neutral-200 dark:border-neutral-800"),children:A===t.id?e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[2fr_1fr_1fr_1fr] gap-4",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-neutral-500 px-1",children:a("common.name")}),e.jsx(l,{value:q,onChange:r=>B(r.target.value),className:"bg-white dark:bg-neutral-950 border-neutral-200 dark:border-neutral-800 text-neutral-900 dark:text-white"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-neutral-500 px-1",children:a("common.sets")}),e.jsx(l,{type:"text",value:w,onChange:r=>Q(r.target.value),className:"bg-white dark:bg-neutral-950 border-neutral-200 dark:border-neutral-800 text-neutral-900 dark:text-white"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-neutral-500 px-1",children:a("common.reps")}),e.jsx(l,{type:"text",value:v,onChange:r=>G(r.target.value),className:"bg-white dark:bg-neutral-950 border-neutral-200 dark:border-neutral-800 text-neutral-900 dark:text-white"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-neutral-500 px-1",children:a("common.rest_seconds")}),e.jsx(l,{type:"number",value:k,onChange:r=>T(r.target.value),className:"bg-white dark:bg-neutral-950 border-neutral-200 dark:border-neutral-800 text-neutral-900 dark:text-white"})]})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-neutral-500 px-1",children:a("common.notes")}),e.jsx(l,{value:D,onChange:r=>X(r.target.value),className:"bg-white dark:bg-neutral-950 border-neutral-200 dark:border-neutral-800 text-neutral-900 dark:text-white"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-neutral-500 px-1",children:a("common.video_url")}),e.jsx(l,{value:m,onChange:r=>F(r.target.value),placeholder:"https://...",className:I("bg-white dark:bg-neutral-950 border-neutral-200 dark:border-neutral-800 text-neutral-900 dark:text-white",y&&"border-red-500")}),y&&e.jsx("p",{className:"text-xs text-red-500 px-1",children:a("common.video_url_invalid","Use http:// or https://")})]}),e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsxs(c,{size:"sm",variant:"ghost",onClick:re,className:"text-neutral-400",children:[e.jsx(he,{className:"h-4 w-4 mr-1"})," ",a("common.cancel")]}),e.jsxs(c,{size:"sm",onClick:()=>le(t.id),disabled:y,className:"bg-emerald-600 hover:bg-emerald-700 text-white",children:[e.jsx(pe,{className:"h-4 w-4 mr-1"})," ",a("common.save")]})]})]}):e.jsxs("div",{className:"flex items-center gap-3",children:[e.jsx(be,{className:"h-5 w-5 text-neutral-600"}),e.jsxs("div",{className:"flex-1",children:[e.jsx("span",{className:"font-medium block",children:t.title}),e.jsxs("div",{className:"flex items-center gap-2",children:[t.default_sets&&e.jsxs("span",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:[t.default_sets," ",a("common.sets").toLowerCase()]}),t.default_reps&&e.jsxs("span",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:[t.default_reps," ",a("common.reps").toLowerCase()]}),t.rest_seconds!=null&&e.jsxs("span",{className:"text-xs text-neutral-500 dark:text-neutral-400",children:[a("common.rest").toLowerCase(),": ",t.rest_seconds,"s"]}),t.notes&&e.jsxs("span",{className:"text-xs text-neutral-500 dark:text-neutral-400 bg-neutral-100 dark:bg-neutral-800 px-1.5 py-0.5 rounded italic",children:[a("common.notes"),": ",t.notes]}),d&&e.jsx("a",{href:d,target:"_blank",rel:"noreferrer",title:a("common.video_url"),className:"inline-flex items-center justify-center h-6 w-6 rounded-full text-emerald-600 hover:text-emerald-700 hover:bg-emerald-500/10",children:e.jsx(ge,{className:"h-4 w-4"})})]})]}),e.jsxs("div",{className:"flex items-center gap-1",children:[e.jsx(c,{size:"icon",variant:"ghost",className:"text-neutral-400 hover:text-neutral-900 dark:hover:text-white hover:bg-neutral-100 dark:hover:bg-neutral-800 h-8 w-8",onClick:()=>se(t),children:e.jsx(Ne,{className:"h-4 w-4"})}),e.jsx(c,{size:"icon",variant:"ghost",className:"text-red-500 hover:text-red-400 hover:bg-red-950/30 h-8 w-8",onClick:()=>O(t.id,n),children:e.jsx(je,{className:"h-4 w-4"})})]})]})},t.id)}),p.length===0&&e.jsx("p",{className:"text-center text-neutral-500 py-8 italic",children:"No exercises yet."})]})]}),e.jsx("div",{className:"bg-neutral-50 dark:bg-neutral-900/50 p-4 rounded-xl border border-neutral-200 dark:border-neutral-800 shadow-sm",children:e.jsxs("form",{onSubmit:ae,className:"space-y-4",children:[e.jsx("h3",{className:"text-sm font-bold uppercase tracking-wider text-emerald-500 px-1",children:a("editor.add_exercise")}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-[2fr_1fr_1fr_1fr_2fr_2fr_auto] gap-4 items-end",children:[e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-neutral-500 px-1",children:a("common.name")}),e.jsx(l,{placeholder:a("common.name"),value:h,onChange:t=>E(t.target.value),className:"bg-white dark:bg-neutral-950 border-neutral-200 dark:border-neutral-800 text-neutral-900 dark:text-white h-12 md:h-10 text-base md:text-sm"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-neutral-500 px-1",children:a("common.sets")}),e.jsx(l,{placeholder:"3",type:"number",value:g,onChange:t=>V(t.target.value),className:"bg-white dark:bg-neutral-950 border-neutral-200 dark:border-neutral-800 text-neutral-900 dark:text-white h-12 md:h-10 text-base md:text-sm"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-neutral-500 px-1",children:a("common.reps")}),e.jsx(l,{placeholder:"12 ou 15/14/13/12",type:"text",value:b,onChange:t=>U(t.target.value),className:"bg-white dark:bg-neutral-950 border-neutral-200 dark:border-neutral-800 text-neutral-900 dark:text-white h-12 md:h-10 text-base md:text-sm"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-neutral-500 px-1",children:a("common.rest_seconds")}),e.jsx(l,{placeholder:"60",type:"number",value:N,onChange:t=>R(t.target.value),className:"bg-white dark:bg-neutral-950 border-neutral-200 dark:border-neutral-800 text-neutral-900 dark:text-white h-12 md:h-10 text-base md:text-sm"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-neutral-500 px-1",children:a("common.notes")}),e.jsx(l,{placeholder:a("common.notes"),value:W,onChange:t=>z(t.target.value),className:"bg-white dark:bg-neutral-950 border-neutral-200 dark:border-neutral-800 text-neutral-900 dark:text-white h-12 md:h-10 text-base md:text-sm"})]}),e.jsxs("div",{className:"space-y-1.5",children:[e.jsx("label",{className:"text-[10px] uppercase font-bold text-neutral-500 px-1",children:a("common.video_url")}),e.jsx(l,{placeholder:"https://...",value:x,onChange:t=>L(t.target.value),className:I("bg-white dark:bg-neutral-950 border-neutral-200 dark:border-neutral-800 text-neutral-900 dark:text-white h-12 md:h-10 text-base md:text-sm",f&&"border-red-500")}),f&&e.jsx("p",{className:"text-xs text-red-500 px-1",children:a("common.video_url_invalid","Use http:// or https://")})]}),e.jsx("div",{className:"flex flex-col justify-end",children:e.jsxs(c,{type:"submit",size:"lg",disabled:$||!h||f,className:"bg-emerald-600 hover:bg-emerald-700 text-white h-12 md:h-10 px-6 shadow-lg shadow-emerald-950/20 w-full md:w-auto",children:[e.jsx(ve,{className:"h-5 w-5 md:h-4 md:w-4 mr-2"})," ",a("common.add")]})})]})]})})]})]})}export{Ue as default};
