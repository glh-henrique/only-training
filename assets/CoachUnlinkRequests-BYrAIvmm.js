import{r as l,j as e}from"./vendor-RJ-jBvc8.js";import{s as x}from"./index-CJN2Yibc.js";import{B as o}from"./button-eI2RqdAi.js";import{u as j}from"./i18n-DvSS2Fqm.js";import{h as b,n as k}from"./icons-CewslWSu.js";import{u as N}from"./router-Db51iocS.js";import"./supabase-BfAM1BYj.js";function C(){const{t}=j(),h=N(),[f,g]=l.useState([]),[c,i]=l.useState(!1),[d,a]=l.useState(null),u=async()=>{i(!0),a(null);try{const{data:s,error:r}=await x.from("coach_student_unlink_requests").select("*").order("created_at",{ascending:!1});if(r)throw r;g(s||[])}catch(s){a(s.message)}finally{i(!1)}};l.useEffect(()=>{u()},[]);const m=async(s,r)=>{a(null);try{const{error:n}=await x.rpc("resolve_unlink_request",{request_id_input:s,approve_input:r});if(n)throw n;await u()}catch(n){a(n.message)}},p=f.filter(s=>s.status==="pending");return e.jsxs("div",{className:"min-h-screen bg-white dark:bg-neutral-950 text-neutral-900 dark:text-white pb-20",children:[e.jsxs("header",{className:"p-4 flex items-center gap-4 border-b border-neutral-200 dark:border-neutral-800 bg-white dark:bg-neutral-950 sticky top-0 z-10",children:[e.jsx(o,{variant:"ghost",size:"icon",onClick:()=>h("/coach-panel"),children:e.jsx(b,{className:"h-5 w-5"})}),e.jsx("h1",{className:"text-xl font-bold",children:t("coach.panel.unlink_requests_title")})]}),e.jsxs("main",{className:"p-4 max-w-3xl mx-auto space-y-3",children:[c&&e.jsx("p",{className:"text-sm text-neutral-500",children:t("common.loading")}),d&&e.jsx("p",{className:"text-sm text-red-500",children:d}),!c&&p.length===0&&e.jsx("p",{className:"text-sm text-neutral-500",children:t("coach.panel.no_unlink_requests")}),p.map(s=>e.jsxs("div",{className:"p-3 rounded-xl border border-neutral-200 dark:border-neutral-800 bg-neutral-50 dark:bg-neutral-900 space-y-2",children:[e.jsxs("div",{className:"flex items-center gap-2 text-amber-500",children:[e.jsx(k,{className:"h-4 w-4"}),e.jsx("span",{className:"text-xs font-semibold",children:t("coach.common.status.pending")})]}),e.jsx("p",{className:"text-sm",children:s.message||t("coach.panel.unlink_no_message")}),e.jsxs("div",{className:"flex gap-2",children:[e.jsx(o,{size:"sm",onClick:()=>m(s.id,!0),children:t("coach.panel.approve")}),e.jsx(o,{size:"sm",variant:"outline",onClick:()=>m(s.id,!1),children:t("coach.panel.deny")})]})]},s.id))]})]})}export{C as default};
